LIBS = @LIBS@
OPTS = -O3
COPT = -Wall
OOPT =
STRIP = strip
CC = gcc

ALL: bnc mkpasswd

mkpasswd:mkpasswd.c
	${CC} ${OPTS} ${COPT} ${LIBS} -o mkpasswd mkpasswd.c
bnc: bnc.o conf.o server.o cmds.o send.o sbuf.o Makefile
	${CC} ${OPTS} ${OOPT} -o bnc bnc.o conf.o server.o cmds.o sbuf.o send.o ${LIBS}
#	${STRIP} bnc

bnc.o: config.h struct.h bnc.c Makefile
	${CC} ${OPTS} ${COPT} -c bnc.c
conf.o: config.h struct.h conf.c Makefile
	${CC} ${OPTS} ${COPT} -c conf.c
cmds.o: config.h struct.h cmds.c Makefile
	${CC} ${OPTS} ${COPT} -c cmds.c
server.o: config.h struct.h server.c Makefile
	${CC} ${OPTS} ${COPT} -c server.c
send.o: send.c send.h Makefile
	${CC} ${OPTS} ${COPT} -c send.c
sbuf.o: sbuf.c
	${CC} ${OPTS} ${COPT} -c sbuf.c

clean:
	rm -rf *.o *~ core bnc mkpasswd
dist-clean: clean
	rm -rf Makefile config.cache config.h config.log config.status pid.bnc bnc.conf* bnc.log
	cp Makefile.out Makefile
distclean: dist-clean
